----BELOW BLOCK WILL DROP THE TABLES AND SEQUENCE THAT WERE ALREADY CREATED, MAKING THE DDL REUSABLE


DECLARE
OBJ_NAME VARCHAR(1000);
BEGIN
FOR I IN (SELECT ROLE FROM DBA_ROLES WHERE ROLE IN ('DB_OWNER', 'DEVELOPER', 'USER_TESTER', 'MAINTENANCE','ANALYST') )
LOOP
OBJ_NAME := ('DROP ' || 'ROLE ' ||' ' || I.ROLE);
DBMS_OUTPUT.PUT_LINE(OBJ_NAME);
EXECUTE IMMEDIATE OBJ_NAME;
END LOOP;
DBMS_OUTPUT.PUT_LINE('STARTING FRESH');
END;
/

---------DROP USERS-----------

DECLARE
OBJ_NAME VARCHAR(1000);
BEGIN
FOR I IN (SELECT USERNAME FROM ALL_USERS WHERE USERNAME IN ('MHATREA', 'KADAMA', 'JADHAVH', 'JOHNJ','TOM') )
LOOP
OBJ_NAME := ('DROP ' || 'USER ' ||' ' || I.USERNAME || ' CASCADE');
DBMS_OUTPUT.PUT_LINE(OBJ_NAME);
EXECUTE IMMEDIATE OBJ_NAME;
END LOOP;
DBMS_OUTPUT.PUT_LINE('STARTING FRESH');
END;
/

--------------------------------------
--          CREATING ROLES
--------------------------------------
    CREATE ROLE DB_OWNER;
    CREATE ROLE DEVELOPER;
    CREATE ROLE USER_TESTER;
    CREATE ROLE MAINTENANCE;
    CREATE ROLE ANALYST;
    
----------------------------------------
--             GRANTING PRIVILEGES TO DB_OWNER
----------------------------------------

GRANT  CONNECT, CREATE SESSION to DB_OWNER;
GRANT CREATE TRIGGER TO DB_OWNER;
GRANT CREATE VIEW TO DB_OWNER;
GRANT CREATE ANY TABLE TO DB_OWNER;
GRANT CREATE SEQUENCE TO DB_OWNER;
GRANT CREATE PROCEDURE TO DB_OWNER;
GRANT CONNECT, CREATE SESSION TO DEVELOPER;
GRANT CREATE ANY TABLE TO DEVELOPER;
GRANT CREATE PROCEDURE TO DEVELOPER;
GRANT CREATE TRIGGER TO DEVELOPER;
GRANT CREATE VIEW TO DEVELOPER;
GRANT CONNECT, CREATE SESSION to USER_TESTER;
GRANT CONNECT, CREATE SESSION to MAINTENANCE;
GRANT CONNECT, CREATE SESSION to ANALYST;

----------------------------------------
--             CREATING USERS
----------------------------------------
    --DB_OWNER
    CREATE USER MHATREA IDENTIFIED BY BikeShare2022
    DEFAULT TABLESPACE DATA
    QUOTA 200M ON DATA; 
    --DEVELOPER
    CREATE USER KADAMA IDENTIFIED BY BikeShare2022
    DEFAULT TABLESPACE DATA
    QUOTA 200M ON DATA;
    --USER_TESTER
    CREATE USER JADHAVH IDENTIFIED BY BikeShare2022
    DEFAULT TABLESPACE DATA
    QUOTA 100M ON DATA;
    --MAINTENANCE
    CREATE USER JOHNJ IDENTIFIED BY BikeShare2022
    DEFAULT TABLESPACE DATA
    QUOTA 100M ON DATA;
    --ANALYST
    CREATE USER TOM IDENTIFIED BY BikeShare2022
    DEFAULT TABLESPACE DATA
    QUOTA 100M ON DATA;
    
 
----------------------------------

-- GRANTING DB_OWNER ROLE TO MHATREA

----------------------------------


GRANT DB_OWNER TO MHATREA;
GRANT DEVELOPER TO KADAMA;
GRANT USER_TESTER TO JADHAVH;
GRANT MAINTENANCE TO JOHNJ;
GRANT ANALYST TO TOM;

----------------------------------

-- TO RUN OBJECT CREATION SCRIPT:- 
-- LOGIN AS MHATREA USER (ROLE - DB_OWNER) (PASSWORD - BikeShare2022)
-- RUN OBJECT CREATION SCRIPT AS MHATREA
-- FOR RUNNING USER CREATION SCRIPT AGAIN DISCONNECT ANY CONNECTED USER BEFORE RUNNING THE SCRIPT.
-- THANK YOU !!!
----------------------------------